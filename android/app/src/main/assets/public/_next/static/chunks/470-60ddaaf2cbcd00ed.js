"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[470],{1554:(e,r,t)=>{t.d(r,{ZJ:()=>o,R8:()=>l,D3:()=>s});var i=t(95155),n=t(12115),a=t(9891);function u(){let[e,r]=(0,n.useState)(null);if((0,n.useEffect)(()=>{let e=e=>{r(e)};return a.d.on("permission-error",e),()=>{a.d.off("permission-error",e)}},[]),e)throw e;return null}let o=(0,n.createContext)(void 0),l=e=>{let{children:r,firebaseApp:t,firestore:a,auth:l}=e,s=(0,n.useMemo)(()=>({firebaseApp:t,firestore:a,auth:l}),[t,a,l]);return(0,i.jsxs)(o.Provider,{value:s,children:[(0,i.jsx)(u,{}),r]})},s=()=>{let e=(0,n.useContext)(o);if(void 0===e)throw Error("useFirebase must be used within a FirebaseProvider.");return e}},7782:(e,r,t)=>{t.d(r,{$9:()=>s.$,de:()=>l.d,AU:()=>c,Ge:()=>d,D3:()=>u.D3});var i=t(45300),n=t(33885),a=t(19708),u=t(1554);t(60097);var o=t(12115),l=t(9891),s=t(86501);function d(e){let[r,t]=(0,o.useState)({data:null,isLoading:!0,error:null}),i=(0,o.useRef)(null);return(0,o.useEffect)(()=>{let r=e?e._query.path.canonicalString():null;if(!e||!r){null!==i.current&&(t({data:null,isLoading:!0,error:null}),i.current=null);return}if(r===i.current)return;i.current=r,t({data:null,isLoading:!0,error:null});let n=(0,a.aQ)(e,e=>{i.current===r&&t({data:e.docs.map(e=>({...e.data(),id:e.id})),isLoading:!1,error:null})},n=>{let a=e._query.path.canonicalString(),u=new s.$({operation:"list",path:a});i.current===r&&(t({data:null,isLoading:!1,error:u}),l.d.emit("permission-error",u))});return()=>n()},[e]),r}function c(){let e=(0,i.r)();return{firebaseApp:e,auth:(0,n.xI)(e),firestore:(0,a.aU)(e)}}},9891:(e,r,t)=>{t.d(r,{d:()=>i});let i=function(){let e={};return{on(r,t){var i;e[r]||(e[r]=[]),null==(i=e[r])||i.push(t)},off(r,t){var i;e[r]&&(e[r]=null==(i=e[r])?void 0:i.filter(e=>e!==t))},emit(r,t){var i;e[r]&&(null==(i=e[r])||i.forEach(e=>e(t)))}}}()},12298:(e,r,t)=>{t.d(r,{J:()=>l});var i=t(12115),n=t(33885),a=t(19708),u=t(1554),o=t(7782);function l(){let e=(0,i.useContext)(u.ZJ),r=null==e?void 0:e.firebaseApp,[t,l]=(0,i.useState)(null),[s,d]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{let e;if(!r)return void d(!1);let t=(0,n.xI)(r),i=(0,a.aU)(r),u=(0,n.hg)(t,r=>{if(e&&e(),r){let t=(0,a.H9)(i,"users",r.uid);e=(0,a.aQ)(t,e=>{let t;if(e.exists()){let i=e.data();t={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,role:i.role||"Utente",notificationChannels:i.notificationChannels||["app","email"],notificationReminderTime:i.notificationReminderTime||3}}else t={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,role:"Utente",notificationChannels:["app","email"],notificationReminderTime:3};l(t),d(!1)},e=>{let r=new o.$9({path:t.path,operation:"get",requestResourceData:{context:"Listening to user document for auth state changes."}});o.de.emit("permission-error",r),l(null),d(!1)})}else l(null),d(!1)});return()=>{u(),e&&e()}},[r]),{user:t,loading:s}}},45300:(e,r,t)=>{let i;t.d(r,{r:()=>u});var n=t(52078);let a={projectId:"studio-99874364-880bd",appId:"1:705618426785:web:ceb3019bef1327ec8f29e0",apiKey:"AIzaSyA8EwPnJ98V4C6d71b5faUjjDtc_dBJoQA",authDomain:"studio-99874364-880bd.firebaseapp.com",measurementId:"",messagingSenderId:"705618426785"};function u(){if(i)return i;if((0,n.Dk)().length)i=(0,n.Sx)();else try{i=(0,n.Wp)()}catch(e){i=(0,n.Wp)(a)}return i}},60097:(e,r,t)=>{t.d(r,{FirebaseClientProvider:()=>o});var i=t(95155),n=t(12115),a=t(1554),u=t(7782);function o(e){let{children:r}=e,t=(0,n.useMemo)(()=>{try{return(0,u.AU)()}catch(e){return console.error("Failed to initialize Firebase",e),{firebaseApp:null,auth:null,firestore:null}}},[]);return t.firebaseApp&&t.auth&&t.firestore?(0,i.jsx)(a.R8,{firebaseApp:t.firebaseApp,auth:t.auth,firestore:t.firestore,children:r}):(0,i.jsx)(i.Fragment,{children:r})}},64269:(e,r,t)=>{t.d(r,{cn:()=>a});var i=t(2821),n=t(75889);function a(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,n.QP)((0,i.$)(r))}},86501:(e,r,t)=>{t.d(r,{$:()=>n});var i=t(33885);class n extends Error{constructor(e){let r=function(e){let r=null;try{let e=(0,i.xI)().currentUser;e&&(r=function(e){var r;if(!e)return null;let t={name:e.displayName,email:e.email,email_verified:e.emailVerified,phone_number:e.phoneNumber,sub:e.uid,firebase:{identities:e.providerData.reduce((e,r)=>(r.providerId&&(e[r.providerId]=[r.uid]),e),{}),sign_in_provider:(null==(r=e.providerData[0])?void 0:r.providerId)||"custom",tenant:e.tenantId}};return{uid:e.uid,token:t}}(e))}catch(e){}return{auth:r,method:e.operation,path:"/databases/(default)/documents/".concat(e.path),resource:e.requestResourceData?{data:e.requestResourceData}:void 0}}(e);super("Missing or insufficient permissions: The following request was denied by Firestore Security Rules:\n".concat(JSON.stringify(r,null,2))),this.name="FirebaseError",this.request=r}}}}]);
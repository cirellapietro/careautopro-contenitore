(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[954],{1715:(e,t,a)=>{"use strict";a.d(t,{D:()=>l,ThemeProvider:()=>n});var s=a(95155),r=a(12115);let i=(0,r.createContext)({theme:"system",setTheme:()=>null});function n(e){let{children:t,defaultTheme:a="system",storageKey:n="vite-ui-theme",...l}=e,[o,d]=(0,r.useState)(()=>localStorage.getItem(n)||a);return(0,r.useEffect)(()=>{let e=window.document.documentElement;if(e.classList.remove("light","dark"),"system"===o){let t=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";e.classList.add(t);return}e.classList.add(o)},[o]),(0,s.jsx)(i.Provider,{...l,value:{theme:o,setTheme:e=>{localStorage.setItem(n,e),d(e)}},children:t})}let l=()=>{let e=(0,r.useContext)(i);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},3998:(e,t,a)=>{"use strict";a.d(t,{$:()=>d,r:()=>o});var s=a(95155),r=a(12115),i=a(32467),n=a(83101),l=a(64269);let o=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:a,variant:r,size:n,asChild:d=!1,...c}=e,m=d?i.DX:"button";return(0,s.jsx)(m,{className:(0,l.cn)(o({variant:r,size:n,className:a})),ref:t,...c})});d.displayName="Button"},30672:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>I});var s=a(95155),r=a(12115),i=a(20063),n=a(52619),l=a.n(n),o=a(98428),d=a(3998),c=a(60186),m=a(63263),u=a(72251),f=a(75797),h=a(64269);let p=c.bL,x=c.l9;c.YJ,c.ZL,c.Pb,c.z6,r.forwardRef((e,t)=>{let{className:a,inset:r,children:i,...n}=e;return(0,s.jsxs)(c.ZP,{ref:t,className:(0,h.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",a),...n,children:[i,(0,s.jsx)(m.A,{className:"ml-auto"})]})}).displayName=c.ZP.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(c.G5,{ref:t,className:(0,h.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}).displayName=c.G5.displayName;let g=r.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...i}=e;return(0,s.jsx)(c.ZL,{children:(0,s.jsx)(c.UC,{ref:t,sideOffset:r,className:(0,h.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...i})})});g.displayName=c.UC.displayName;let j=r.forwardRef((e,t)=>{let{className:a,inset:r,...i}=e;return(0,s.jsx)(c.q7,{ref:t,className:(0,h.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",a),...i})});j.displayName=c.q7.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,checked:i,...n}=e;return(0,s.jsxs)(c.H_,{ref:t,className:(0,h.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:i,...n,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(c.VF,{children:(0,s.jsx)(u.A,{className:"h-4 w-4"})})}),r]})}).displayName=c.H_.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,...i}=e;return(0,s.jsxs)(c.hN,{ref:t,className:(0,h.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...i,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(c.VF,{children:(0,s.jsx)(f.A,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=c.hN.displayName;let v=r.forwardRef((e,t)=>{let{className:a,inset:r,...i}=e;return(0,s.jsx)(c.JU,{ref:t,className:(0,h.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",a),...i})});v.displayName=c.JU.displayName;let b=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(c.wv,{ref:t,className:(0,h.cn)("-mx-1 my-1 h-px bg-muted",a),...r})});b.displayName=c.wv.displayName;var y=a(85989),N=a(12784),w=a(1715);function k(){let{setTheme:e}=(0,w.D)();return(0,s.jsxs)(p,{children:[(0,s.jsx)(x,{asChild:!0,children:(0,s.jsxs)(d.$,{variant:"outline",size:"icon",children:[(0,s.jsx)(y.A,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),(0,s.jsx)(N.A,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),(0,s.jsx)("span",{className:"sr-only",children:"Toggle theme"})]})}),(0,s.jsxs)(g,{align:"end",children:[(0,s.jsx)(j,{onClick:()=>e("light"),children:"Light"}),(0,s.jsx)(j,{onClick:()=>e("dark"),children:"Dark"}),(0,s.jsx)(j,{onClick:()=>e("system"),children:"System"})]})]})}var C=a(76604),R=a(63366);let _=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(R.bL,{ref:t,className:(0,h.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...r})});_.displayName=R.bL.displayName;let A=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(R._V,{ref:t,className:(0,h.cn)("aspect-square h-full w-full",a),...r})});A.displayName=R._V.displayName;let z=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(R.H4,{ref:t,className:(0,h.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...r})});z.displayName=R.H4.displayName;var L=a(12298),U=a(63279);let E=()=>{let{user:e}=(0,L.J)(),t=(0,i.useRouter)(),a=async()=>{await (0,U.CI)(),t.push("/login")};if(!e)return null;let r=e.displayName?e.displayName.charAt(0).toUpperCase():e.email?e.email.charAt(0).toUpperCase():"?";return(0,s.jsxs)(p,{children:[(0,s.jsx)(x,{asChild:!0,children:(0,s.jsx)(d.$,{variant:"outline",size:"icon",className:"overflow-hidden rounded-full",children:(0,s.jsxs)(_,{children:[(0,s.jsx)(A,{src:e.photoURL||"",alt:e.displayName||""}),(0,s.jsx)(z,{children:r})]})})}),(0,s.jsxs)(g,{align:"end",children:[(0,s.jsx)(v,{children:e.displayName||e.email}),(0,s.jsx)(b,{}),(0,s.jsx)(j,{asChild:!0,children:(0,s.jsx)(l(),{href:"/dashboard/profile",children:"Profilo"})}),"Amministratore"===e.role&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b,{}),(0,s.jsx)(v,{children:"Amministrazione"}),(0,s.jsx)(j,{asChild:!0,children:(0,s.jsx)(l(),{href:"/dashboard/admin/users",children:"Gestione Utenti"})}),(0,s.jsx)(j,{asChild:!0,children:(0,s.jsx)(l(),{href:"/dashboard/admin/vehicle-types",children:"Gestione Tipi Veicolo"})}),(0,s.jsx)(j,{asChild:!0,children:(0,s.jsx)(l(),{href:"/dashboard/admin/roles",children:"Gestione Ruoli"})}),(0,s.jsx)(j,{asChild:!0,children:(0,s.jsx)(l(),{href:"/dashboard/admin/settings",children:"Impostazioni"})})]}),(0,s.jsx)(b,{}),(0,s.jsxs)(j,{onClick:a,className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)(o.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Esci"})]})]})]})};function P(){return(0,s.jsxs)("header",{className:"sticky top-0 z-30 flex h-16 items-center justify-between border-b bg-background px-4 md:px-6",children:[(0,s.jsx)(l(),{href:"/dashboard",children:(0,s.jsx)(C.g,{})}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(k,{}),(0,s.jsx)(E,{})]})]})}var H=a(92033);function I(e){let{children:t}=e,{user:a,loading:n}=(0,L.J)(),o=(0,i.useRouter)(),d=(0,i.usePathname)();return((0,r.useEffect)(()=>{n||a||o.push("/login")},[a,n,o]),n||!a)?(0,s.jsxs)("div",{className:"flex min-h-screen w-full flex-col items-center justify-center bg-background",children:[(0,s.jsx)(H.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,s.jsx)("p",{className:"mt-4 text-muted-foreground",children:"Caricamento..."})]}):(0,s.jsxs)("div",{className:"flex min-h-screen w-full flex-col",children:[(0,s.jsx)(P,{}),(0,s.jsx)("div",{className:"border-b",children:(0,s.jsx)("div",{className:"container flex-1 items-start md:grid md:gap-6 lg:gap-10",children:(0,s.jsx)("nav",{className:"flex gap-4 overflow-x-auto py-4",children:[{href:"/dashboard/statistics",label:"Statistiche"},{href:"/dashboard/vehicles",label:"Veicoli"},{href:"/dashboard/interventions",label:"Interventi"},{href:"/dashboard/notifications",label:"Notifiche"}].map(e=>(0,s.jsx)(l(),{href:e.href,className:(0,h.cn)("shrink-0 rounded-md px-3 py-2 text-sm font-medium transition-colors",d.startsWith(e.href)?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted"),children:e.label},e.href))})})}),(0,s.jsx)("main",{className:"flex-1 flex-col gap-4 p-4 md:gap-8 md:p-8",children:t}),(0,s.jsx)("footer",{className:"mt-auto border-t bg-secondary py-4",children:(0,s.jsx)("div",{className:"container flex items-center justify-end",children:(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Versione: 1.0.0"})})})]})}},49380:(e,t,a)=>{Promise.resolve().then(a.bind(a,30672))},63279:(e,t,a)=>{"use strict";let s,r;a.d(t,{CI:()=>g,G6:()=>x,Ru:()=>h,bk:()=>p});var i=a(33885),n=a(19708),l=a(45300),o=a(9891),d=a(86501);function c(){if(s)return s;let e=(0,l.r)();return s=(0,i.xI)(e)}function m(){if(r)return r;let e=(0,l.r)();return r=(0,n.aU)(e)}let u=new i.HF;async function f(e,t,a,s){let r=m(),i=(0,n.H9)(r,"users",e),l={id:e,email:t,displayName:a,photoURL:s,role:"cirellapietro@gmail.com"===t?"Amministratore":"Utente",notificationChannels:["app","email"],notificationReminderTime:3,dataoraelimina:null};(0,n.BN)(i,l,{merge:!0}).catch(e=>{let t=new d.$({path:i.path,operation:"create",requestResourceData:l});o.d.emit("permission-error",t)})}async function h(e,t){let a=c(),s=await (0,i.x9)(a,e,t);if(s.user&&"cirellapietro@gmail.com"===e){let e=m(),t=(0,n.H9)(e,"users",s.user.uid);try{let e=await (0,n.x7)(t);if(e.exists()){if("Amministratore"!==e.data().role){let e={role:"Amministratore"};(0,n.mZ)(t,e).catch(a=>{let s=new d.$({path:t.path,operation:"update",requestResourceData:e});o.d.emit("permission-error",s)})}}else await f(s.user.uid,s.user.email,s.user.displayName,s.user.photoURL)}catch(a){let e=new d.$({path:t.path,operation:"get"});o.d.emit("permission-error",e)}}}async function p(e,t,a){let s=c(),r=(await (0,i.eJ)(s,e,t)).user;await (0,i.r7)(r,{displayName:a}),await f(r.uid,r.email,a,r.photoURL)}async function x(){let e=c(),t=(await (0,i.df)(e,u)).user,a=m(),s=(0,n.H9)(a,"users",t.uid);try{let e=await (0,n.x7)(s);if(e.exists()){if("cirellapietro@gmail.com"===t.email&&"Amministratore"!==e.data().role){let e={role:"Amministratore"};(0,n.mZ)(s,e).catch(t=>{let a=new d.$({path:s.path,operation:"update",requestResourceData:e});o.d.emit("permission-error",a)})}}else await f(t.uid,t.email,t.displayName,t.photoURL)}catch(t){let e=new d.$({path:s.path,operation:"get"});o.d.emit("permission-error",e)}}async function g(){let e=c();await (0,i.CI)(e)}},76604:(e,t,a)=>{"use strict";a.d(t,{g:()=>n});var s=a(95155),r=a(15957),i=a(64269);function n(e){let{className:t}=e;return(0,s.jsxs)("div",{className:(0,i.cn)("flex items-center gap-2",t),children:[(0,s.jsx)(r.A,{className:"h-6 w-6 text-accent"}),(0,s.jsx)("span",{className:"font-headline text-xl font-bold text-primary dark:text-primary-foreground",children:"CareAutoPro"})]})}}},e=>{e.O(0,[992,811,909,668,237,431,935,118,64,764,470,441,255,358],()=>e(e.s=49380)),_N_E=e.O()}]);